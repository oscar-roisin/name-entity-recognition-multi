{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# NER - Multilang"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using TensorFlow backend.\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import csv\n",
    "import tensorflow as tf\n",
    "import pickle\n",
    "import keras\n",
    "from sklearn.model_selection import cross_val_predict\n",
    "from sklearn.metrics import classification_report\n",
    "\n",
    "# Mainly Used:\n",
    "# https://www.depends-on-the-definition.com/sequence-tagging-lstm-crf/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "done\n"
     ]
    }
   ],
   "source": [
    "# \"OBJ/ORG\" -> ORG\n",
    "# \"EVN\" -> \"OTHER\"\n",
    "# \"LOC/LOC\" -> LOC\n",
    "# \"LOC/ORG\" -> LOC\n",
    "# \"LOC/PRS\" -> LOC\n",
    "# MSR -> OTHER\n",
    "# OBJ -> Other\n",
    "# TME -> Other\n",
    "# animal -> other\n",
    "# inst -> ORG\n",
    "# other -> OTHER\n",
    "# person -> PRS\n",
    "# place -> LOC\n",
    "# product -> OTHER\n",
    "# work -> OTHER\n",
    "\n",
    "# SWE-TAGSET:[\"ORG\",\"PRS\",\"LOC\",\"OTHER\",\"O\"] \n",
    "def sweStandardizeTag(line):\n",
    "    SWE_TAG_SET=[\"ORG\",\"PRS\",\"LOC\",\"OTHER\",\"O\"]\n",
    "    lineParts = line.split(\"\\t\")\n",
    "    ner_tag = lineParts[2]\n",
    "    if ner_tag in SWE_TAG_SET:\n",
    "        return line\n",
    "    if ner_tag[:3] == \"LOC\" or ner_tag == \"place\":\n",
    "        ner_tag = \"LOC\"\n",
    "    if ner_tag == \"person\":\n",
    "        ner_tag = \"PRS\"\n",
    "    if ner_tag in [\"inst\", \"ORG/PRS\", \"OBJ/ORG\"]:\n",
    "        ner_tag = \"ORG\"\n",
    "    if ner_tag in [\"WRK\",\"OBJ\",\"EVN\",\"product\",\"other\",\"work\",\"event\",\"myth\",\"animal\",\"MSR\",\"TME\",\"PRS/WRK\"]:\n",
    "        ner_tag = \"OTHER\"\n",
    "    \n",
    "    if ner_tag not in SWE_TAG_SET:\n",
    "        raise Exception(ner_tag + \" - not in tag set\") \n",
    "    return lineParts[0] + \"\\t\" + lineParts[1] + \"\\t\" + ner_tag\n",
    "\n",
    "\n",
    "DATA_DIR=\"../DATA\"\n",
    "filenames = [ \"swedish.txt\"]#, \"french.txt\", \"english.txt\"]\n",
    "for filename in filenames:\n",
    "    originalFile= open(DATA_DIR + \"/\" + filename,\"r\")\n",
    "    file= open(DATA_DIR + \"/sent_\" + filename,\"w+\")\n",
    "    originalFileLines =originalFile.readlines()\n",
    "    sentId=1\n",
    "    for line in originalFileLines:\n",
    "        line = line.strip() # problem with this?\n",
    "        if len(line) == 0:\n",
    "            sentId = sentId + 1\n",
    "            continue\n",
    "        line = sweStandardizeTag(line)\n",
    "        file.write(str(sentId) + \"\\t\" + line +\"\\n\")\n",
    "# for i in range(10):\n",
    "#      file.write(\"This is line %d\\r\\n\" % (i+1))\n",
    "    file.close()\n",
    "    originalFile.close()\n",
    "print(\"done\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Read Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "106916\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sent</th>\n",
       "      <th>token</th>\n",
       "      <th>pos</th>\n",
       "      <th>ner</th>\n",
       "      <th>token_shape</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>I</td>\n",
       "      <td>PP</td>\n",
       "      <td>O</td>\n",
       "      <td>X</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>sin</td>\n",
       "      <td>PS</td>\n",
       "      <td>O</td>\n",
       "      <td>x</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>första</td>\n",
       "      <td>RO</td>\n",
       "      <td>O</td>\n",
       "      <td>x</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>reaktion</td>\n",
       "      <td>NN</td>\n",
       "      <td>O</td>\n",
       "      <td>x</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>på</td>\n",
       "      <td>PP</td>\n",
       "      <td>O</td>\n",
       "      <td>x</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   sent     token pos ner token_shape\n",
       "0     1         I  PP   O           X\n",
       "1     1       sin  PS   O           x\n",
       "2     1    första  RO   O           x\n",
       "3     1  reaktion  NN   O           x\n",
       "4     1        på  PP   O           x"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "DATA_DIR=\"../DATA\"\n",
    "SENT_COL=\"sent\"\n",
    "TOKEN_COL=\"token\"\n",
    "TOKEN_SHAPE_COL=\"token_shape\"\n",
    "POS_COL=\"pos\"\n",
    "NER_COL=\"ner\"\n",
    "\n",
    "TOKEN_SHAPE_CAT_COL=\"token_shape_cat\"\n",
    "POS_CAT_COL=\"pos_cat\"\n",
    "POS_PREV_CAT_COL=\"pos_prev_cat\"\n",
    "POS_NEXT_CAT_COL=\"pos_next_cat\"\n",
    "POS_PREV_PREV_CAT_COL=\"pos_prev_prev_cat\"\n",
    "NER_CAT_COL=\"ner_cat\"\n",
    "\n",
    "filenames = [ \"sent_swedish.txt\", \"sent_english.txt\", \"sent_french.txt\"]\n",
    "\n",
    "swe_data = pd.read_csv( DATA_DIR + '/' + filenames[0], sep=\"\\t\", header=None, quoting=csv.QUOTE_NONE)\n",
    "eng_data = pd.read_csv( DATA_DIR + '/' + filenames[1], sep=\"\\t\", header=None, quoting=csv.QUOTE_NONE)\n",
    "fr_data = pd.read_csv( DATA_DIR + '/' + filenames[2], sep=\"\\t\", header=None, quoting=csv.QUOTE_NONE)\n",
    "\n",
    "def analyseTokens(df):\n",
    "    #tokens = [\"\\\"\",\"'\",\",\",\".\",\"-\",\"_\"]\n",
    "    new_token_col = []\n",
    "    for token in df[TOKEN_COL]:\n",
    "        #print(token)\n",
    "        token=token.strip()\n",
    "        token_shape = \"\"\n",
    "        if len(token) == 1 and not token.isalnum():\n",
    "            token_shape = \"sign\" # or =token\n",
    "        else:\n",
    "            if token.isupper():\n",
    "                token_shape=\"X\"\n",
    "            elif token[0].isupper():\n",
    "                token_shape=\"Xx\"\n",
    "            else:\n",
    "                token_shape=\"x\"\n",
    "            if token[len(token)-1] == \".\":\n",
    "                token_shape+=\".\"\n",
    "        new_token_col.append(token_shape)\n",
    "    #print(len(new_token_col))\n",
    "    df[TOKEN_SHAPE_COL]=new_token_col\n",
    "\n",
    "def offsetArray(array,offset):\n",
    "    return np.roll(array,offset)\n",
    "    \n",
    "dataframes = [ swe_data, eng_data, fr_data ]\n",
    "dataframes = [ swe_data ] #TODO remove\n",
    "\n",
    "for df in dataframes:\n",
    "    df.columns = [ SENT_COL, TOKEN_COL, POS_COL, NER_COL ]\n",
    "    analyseTokens(df)\n",
    "#     df[NER_COL] = pd.Categorical(df[NER_COL])\n",
    "#     df[NER_CAT_COL] = df[NER_COL].cat.codes\n",
    "#     df[POS_COL] = pd.Categorical(df[POS_COL])\n",
    "#     df[POS_CAT_COL] = df[POS_COL].cat.codes\n",
    "#     df[TOKEN_SHAPE_COL] = pd.Categorical(df[TOKEN_SHAPE_COL])\n",
    "#     df[TOKEN_SHAPE_CAT_COL] = df[TOKEN_SHAPE_COL].cat.codes\n",
    "    \n",
    "#     df[POS_PREV_CAT_COL] = offsetArray(df[POS_CAT_COL],1)\n",
    "#     df[POS_PREV_PREV_CAT_COL] = offsetArray(df[POS_CAT_COL],2)\n",
    "#     df[POS_NEXT_CAT_COL] = offsetArray(df[POS_CAT_COL],-1)\n",
    "\n",
    "# for data in swe_data[POS_CAT_COL].head():\n",
    "#     print(data)\n",
    "\n",
    "#swe_POS_max = max(swe_data[POS_CAT_COL].head())\n",
    "#swe_NER_max = max(swe_data[NER_CAT_COL].head())\n",
    "#swe_SHAPE_max = max(swe_data[TOKEN_SHAPE_CAT_COL].head())\n",
    "\n",
    "words = list(set(swe_data[\"token\"].values))\n",
    "n_words = len(words);\n",
    "print(n_words)\n",
    "\n",
    "DATA_TESTED = swe_data.head(10000)\n",
    "words = DATA_TESTED[TOKEN_COL].values.tolist()\n",
    "tags = DATA_TESTED[NER_COL].values.tolist()\n",
    "\n",
    "swe_data.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['I', 'sin', 'första', 'reaktion', 'på', 'Sovjetledarens', 'varningar', 'deklarerade', 'Litauens', 'president', 'Vytautas', 'Landsbergis', 'att', '\"', 'nu', 'avvisar', 'Gorbatjov', 'vår', 'utsträckta', 'hand', 'med', 'extremt', 'skarpa', 'och', 'hämndlystna', 'ord', '\"', '.']\n",
      "['PP', 'PS', 'RO', 'NN', 'PP', 'NN', 'NN', 'VB', 'PM', 'NN', 'PM', 'PM', 'SN', 'PAD', 'AB', 'VB', 'PM', 'PS', 'PC', 'NN', 'PP', 'AB', 'JJ', 'KN', 'JJ', 'NN', 'PAD', 'MAD']\n",
      "['O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'LOC', 'O', 'PRS', 'PRS', 'O', 'O', 'O', 'O', 'PRS', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O', 'O']\n"
     ]
    }
   ],
   "source": [
    "class SentenceGetter(object):\n",
    "    \n",
    "    def __init__(self, df):\n",
    "        self.n_sent = 1\n",
    "        self.df = df\n",
    "        self.empty = False\n",
    "    \n",
    "    def get_next(self):\n",
    "        try:\n",
    "            sub_df = self.df[self.df[SENT_COL] == self.n_sent]\n",
    "            self.n_sent += 1\n",
    "            return sub_df[TOKEN_COL].values.tolist(), sub_df[POS_COL].values.tolist(), sub_df[NER_COL].values.tolist()    \n",
    "        except:\n",
    "            self.empty = True\n",
    "            print(\"EMPTY\")\n",
    "            return None, None, None\n",
    "getter = SentenceGetter(swe_data)\n",
    "sent, pos, tag = getter.get_next()\n",
    "print(sent); \n",
    "print(pos); \n",
    "print(tag)\n",
    "\n",
    "DATA_TESTED = swe_data.head(10000)\n",
    "\n",
    "words = DATA_TESTED[TOKEN_COL].values.tolist()\n",
    "tags = DATA_TESTED[NER_COL].values.tolist()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "         LOC       0.97      0.62      0.75       228\n",
      "           O       0.97      1.00      0.98      9277\n",
      "         ORG       0.82      0.39      0.53        94\n",
      "       OTHER       0.85      0.42      0.56        67\n",
      "         PRS       0.97      0.59      0.73       334\n",
      "\n",
      "    accuracy                           0.97     10000\n",
      "   macro avg       0.91      0.60      0.71     10000\n",
      "weighted avg       0.97      0.97      0.96     10000\n",
      "\n"
     ]
    }
   ],
   "source": [
    "# TODO REMOVE THIS CELL\n",
    "from sklearn.base import BaseEstimator, TransformerMixin\n",
    "\n",
    "\n",
    "class MemoryTagger(BaseEstimator, TransformerMixin):\n",
    "    \n",
    "    def fit(self, X, y):\n",
    "        '''\n",
    "        Expects a list of words as X and a list of tags as y.\n",
    "        '''\n",
    "        voc = {}\n",
    "        self.tags = []\n",
    "        for x, t in zip(X, y):\n",
    "            if t not in self.tags:\n",
    "                self.tags.append(t)\n",
    "            if x in voc:\n",
    "                if t in voc[x]:\n",
    "                    voc[x][t] += 1\n",
    "                else:\n",
    "                    voc[x][t] = 1\n",
    "            else:\n",
    "                voc[x] = {t: 1}\n",
    "        self.memory = {}\n",
    "        for k, d in voc.items():\n",
    "            self.memory[k] = max(d, key=d.get)\n",
    "    \n",
    "    def predict(self, X, y=None):\n",
    "        '''\n",
    "        Predict the the tag from memory. If word is unknown, predict 'O'.\n",
    "        '''\n",
    "        return [self.memory.get(x, 'O') for x in X]\n",
    "    \n",
    "# tagger = MemoryTagger()\n",
    "#words = swe_data[TOKEN_COL].values.tolist()\n",
    "#tags = swe_data[NER_COL].values.tolist()\n",
    "pred = cross_val_predict(estimator=MemoryTagger(), X=words, y=tags, cv=5)\n",
    "report = classification_report(y_pred=pred, y_true=tags)\n",
    "print(report)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      sent        token pos    ner token_shape\n",
      "986     56        Gamla  JJ  OTHER          Xx\n",
      "987     56  testamentet  NN  OTHER           x\n",
      "1989   119        Gamla  JJ  OTHER          Xx\n",
      "1990   119  testamentet  NN  OTHER           x\n",
      "2361   142         Ofek  PM  OTHER          Xx\n",
      "2362   142            1  RG  OTHER           x\n",
      "3121   194     Qingming  PM  OTHER          Xx\n",
      "3646   230   kungsäpple  NN  OTHER           x\n",
      "3877   246     Qingming  PM  OTHER          Xx\n",
      "4696   299        Aroma  PM  OTHER          Xx\n"
     ]
    }
   ],
   "source": [
    "# \"OBJ/ORG\" -> ORG\n",
    "# \"EVN\" -> \"OTHER\"\n",
    "# \"LOC/LOC\" -> LOC\n",
    "# \"LOC/ORG\" -> LOC\n",
    "# \"LOC/PRS\" -> LOC\n",
    "# MSR -> OTHER\n",
    "# OBJ -> Other\n",
    "# TME -> Other\n",
    "# animal -> other\n",
    "# inst -> ORG\n",
    "# other -> OTHER\n",
    "# person -> PRS\n",
    "# place -> LOC\n",
    "# product -> OTHER\n",
    "# work -> OTHER\n",
    "\n",
    "# SWE-TAGSET:[\"ORG\",\"PRS\",\"LOC\",\"OTHER\",\"O\"] \n",
    "\n",
    "sub_df = swe_data[swe_data[NER_COL] == \"OTHER\"]\n",
    "print(sub_df.head(10))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "         LOC       0.38      0.43      0.40       228\n",
      "           O       0.98      0.98      0.98      9277\n",
      "         ORG       0.24      0.05      0.09        94\n",
      "       OTHER       0.14      0.03      0.05        67\n",
      "         PRS       0.45      0.49      0.47       334\n",
      "\n",
      "    accuracy                           0.94     10000\n",
      "   macro avg       0.44      0.40      0.40     10000\n",
      "weighted avg       0.93      0.94      0.94     10000\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "def feature_map(word):\n",
    "    '''Simple feature map.'''\n",
    "    return np.array([word.istitle(), word.islower(), word.isupper(), len(word),\n",
    "                     word.isdigit(),  word.isalpha()])\n",
    "#df = swe_data\n",
    "words = [feature_map(w) for w in DATA_TESTED[TOKEN_COL].values.tolist()]\n",
    "pred = cross_val_predict(RandomForestClassifier(n_estimators=20),\n",
    "                         X=words, y=tags, cv=5)\n",
    "report = classification_report(y_pred=pred, y_true=tags)\n",
    "print(report)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "done\n"
     ]
    }
   ],
   "source": [
    "words = list(set(DATA_TESTED[TOKEN_COL].values))\n",
    "n_words = len(words); n_words\n",
    "\n",
    "class SentenceGetter(object):\n",
    "    \n",
    "    def __init__(self, data):\n",
    "        self.n_sent = 1\n",
    "        self.data = data\n",
    "        self.empty = False\n",
    "        agg_func = lambda s: [(w, p, t) for w, p, t in zip(s[TOKEN_COL].values.tolist(),\n",
    "                                                           s[POS_COL].values.tolist(),\n",
    "                                                           s[NER_COL].values.tolist())]\n",
    "        self.grouped = self.data.groupby(SENT_COL).apply(agg_func)\n",
    "        self.sentences = [s for s in self.grouped]\n",
    "    \n",
    "    def get_next(self):\n",
    "        try:\n",
    "            s = self.grouped[self.n_sent]\n",
    "            self.n_sent += 1\n",
    "            return s\n",
    "        except:\n",
    "            return None\n",
    "\n",
    "getter = SentenceGetter(DATA_TESTED)\n",
    "sentences = getter.sentences\n",
    "\n",
    "def word2features(sent, i):\n",
    "    word = sent[i][0]\n",
    "    postag = sent[i][1]\n",
    "\n",
    "    features = {\n",
    "        'bias': 1.0,\n",
    "        'word.lower()': word.lower(),\n",
    "        'word[-3:]': word[-3:],\n",
    "        'word[-2:]': word[-2:],\n",
    "        'word.isupper()': word.isupper(),\n",
    "        'word.istitle()': word.istitle(),\n",
    "        'word.isdigit()': word.isdigit(),\n",
    "        'postag': postag,\n",
    "        'postag[:2]': postag[:2],\n",
    "    }\n",
    "    if i > 0:\n",
    "        word1 = sent[i-1][0]\n",
    "        postag1 = sent[i-1][1]\n",
    "        features.update({\n",
    "            '-1:word.lower()': word1.lower(),\n",
    "            '-1:word.istitle()': word1.istitle(),\n",
    "            '-1:word.isupper()': word1.isupper(),\n",
    "            '-1:postag': postag1,\n",
    "            '-1:postag[:2]': postag1[:2],\n",
    "        })\n",
    "    else:\n",
    "        features['BOS'] = True\n",
    "\n",
    "    if i < len(sent)-1:\n",
    "        word1 = sent[i+1][0]\n",
    "        postag1 = sent[i+1][1]\n",
    "        features.update({\n",
    "            '+1:word.lower()': word1.lower(),\n",
    "            '+1:word.istitle()': word1.istitle(),\n",
    "            '+1:word.isupper()': word1.isupper(),\n",
    "            '+1:postag': postag1,\n",
    "            '+1:postag[:2]': postag1[:2],\n",
    "        })\n",
    "    else:\n",
    "        features['EOS'] = True\n",
    "\n",
    "    return features\n",
    "\n",
    "\n",
    "def sent2features(sent):\n",
    "    return [word2features(sent, i) for i in range(len(sent))]\n",
    "\n",
    "def sent2labels(sent):\n",
    "    return [label for token, postag, label in sent]\n",
    "\n",
    "def sent2tokens(sent):\n",
    "    return [token for token, postag, label in sent]\n",
    "\n",
    "X = [sent2features(s) for s in sentences]\n",
    "y = [sent2labels(s) for s in sentences]\n",
    "\n",
    "print(\"done\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "         LOC       0.79      0.83      0.81       228\n",
      "           O       0.99      1.00      1.00      9277\n",
      "         ORG       0.77      0.38      0.51        94\n",
      "       OTHER       0.79      0.40      0.53        67\n",
      "         PRS       0.87      0.91      0.89       334\n",
      "\n",
      "    accuracy                           0.98     10000\n",
      "   macro avg       0.84      0.71      0.75     10000\n",
      "weighted avg       0.98      0.98      0.98     10000\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "CRF(algorithm='lbfgs', all_possible_states=None, all_possible_transitions=False,\n",
       "    averaging=None, c=None, c1=0.1, c2=0.1, calibration_candidates=None,\n",
       "    calibration_eta=None, calibration_max_trials=None, calibration_rate=None,\n",
       "    calibration_samples=None, delta=None, epsilon=None, error_sensitive=None,\n",
       "    gamma=None, keep_tempfiles=None, linesearch=None, max_iterations=100,\n",
       "    max_linesearch=None, min_freq=None, model_filename=None, num_memories=None,\n",
       "    pa_type=None, period=None, trainer_cls=None, variance=None, verbose=False)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn_crfsuite import CRF\n",
    "\n",
    "crf = CRF(algorithm='lbfgs',\n",
    "          c1=0.1,\n",
    "          c2=0.1,\n",
    "          max_iterations=100,\n",
    "          all_possible_transitions=False)\n",
    "pred = cross_val_predict(estimator=crf, X=X, y=y, cv=5)\n",
    "from sklearn_crfsuite.metrics import flat_classification_report\n",
    "report = flat_classification_report(y_pred=pred, y_true=y)\n",
    "print(report)\n",
    "crf.fit(X, y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "    <style>\n",
       "    table.eli5-weights tr:hover {\n",
       "        filter: brightness(85%);\n",
       "    }\n",
       "</style>\n",
       "\n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "<table class=\"eli5-transition-features\" style=\"margin-bottom: 0.5em;\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <td>From \\ To</td>\n",
       "            \n",
       "                <th>LOC</th>\n",
       "            \n",
       "                <th>O</th>\n",
       "            \n",
       "                <th>ORG</th>\n",
       "            \n",
       "                <th>OTHER</th>\n",
       "            \n",
       "                <th>PRS</th>\n",
       "            \n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        \n",
       "            \n",
       "                <tr>\n",
       "                    <th>LOC</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 82.52%)\" title=\"LOC &rArr; LOC\">\n",
       "                            3.594\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 93.16%)\" title=\"LOC &rArr; O\">\n",
       "                            -0.941\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 99.92%)\" title=\"LOC &rArr; OTHER\">\n",
       "                            0.002\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; PRS\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>O</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 97.17%)\" title=\"O &rArr; LOC\">\n",
       "                            -0.267\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 85.33%)\" title=\"O &rArr; O\">\n",
       "                            2.798\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 97.25%)\" title=\"O &rArr; ORG\">\n",
       "                            -0.255\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"O &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 92.98%)\" title=\"O &rArr; PRS\">\n",
       "                            -0.976\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>ORG</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 95.72%)\" title=\"ORG &rArr; O\">\n",
       "                            -0.481\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 80.00%)\" title=\"ORG &rArr; ORG\">\n",
       "                            4.355\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; PRS\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>OTHER</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 92.31%)\" title=\"OTHER &rArr; O\">\n",
       "                            -1.112\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 82.00%)\" title=\"OTHER &rArr; OTHER\">\n",
       "                            3.746\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; PRS\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>PRS</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 97.16%)\" title=\"PRS &rArr; O\">\n",
       "                            -0.268\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 80.17%)\" title=\"PRS &rArr; PRS\">\n",
       "                            4.303\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "        \n",
       "    </tbody>\n",
       "</table>\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "    \n",
       "        <table class=\"eli5-weights-wrapper\" style=\"border-collapse: collapse; border: none; margin-bottom: 1.5em;\">\n",
       "            <tr>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=LOC\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=O\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=ORG\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=OTHER\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=PRS\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "            </tr>\n",
       "            <tr>\n",
       "                \n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 88.47%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.003\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():förbundsrepubliken\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 89.23%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.818\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():vilnius\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 89.27%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.808\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():moskva\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.32%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.559\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():i\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.58%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.500\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ken\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.13%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.378\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ul\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.40%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.317\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ens\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.45%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.307\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ran\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.51%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.294\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.51%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.294\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.63%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.267\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():fridens\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.63%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.267\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():torg\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.65%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.262\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():sovjetunionen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.70%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.253\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():i\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.08%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.170\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ien\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.09%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.169\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ina\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.19%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.148\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.istitle()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.19%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.148\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:org\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.21%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.143\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:nds\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.24%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.137\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ds\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.26%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.133\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:nd\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.36%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.113\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ael\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.36%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.113\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():israel\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.41%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.102\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():london\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.45%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.093\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():hongkong\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.47%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.089\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ON\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.50%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.084\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:jet\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.51%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.082\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():sovjet\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.62%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.059\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:SA\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.62%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 224 more positive &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 92.42%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 33 more negative &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 92.42%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.100\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:gen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 82.86%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +3.528\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        bias\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 84.90%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.944\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        BOS\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 87.03%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.369\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        EOS\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.79%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.453\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.79%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.453\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.81%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.227\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.81%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.227\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.88%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.214\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:an\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.11%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.165\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():litauens\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.76%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.030\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.76%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.030\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.89%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.003\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():sista\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.97%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.988\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():behöver\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.98%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.986\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():jaktviggarna\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.29%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.924\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:rna\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.42%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.898\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:VB\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.42%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.898\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:VB\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.61%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.863\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:nan\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.61%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 127 more positive &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 93.17%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 109 more negative &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 93.17%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.947\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():de\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 93.16%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.950\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():regeringen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 93.13%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.955\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.isupper()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 92.97%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.987\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():president\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 92.42%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.099\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.isdigit()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 92.16%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.154\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():vid\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 91.91%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.207\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ken\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 91.88%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.214\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:sor\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 91.86%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.217\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.isupper()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 86.40%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -2.535\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.istitle()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 80.00%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -4.398\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 80.00%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -4.398\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 87.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.351\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():parlament\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 88.46%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.004\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():mera\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 88.85%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.908\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():vid\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 89.45%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.763\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]::s\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.33%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.558\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():landstingsförbundets\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.33%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.332\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():kabi-gen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.33%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.332\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:Gen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.331\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():litauens\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.331\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ato\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.331\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():nato\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.330\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:to\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.43%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.311\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():saab\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.43%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.311\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:aab\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.43%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.311\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ab\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.56%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.282\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():västerbotten\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.26%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.132\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():cdu-ledda\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.117\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:vD\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.117\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:SvD\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.34%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.117\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():svd\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.51%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.081\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():naturskyddsförening\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.51%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.081\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():järfälla\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.60%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.064\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():regeringen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.67%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.049\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():dn\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.67%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.049\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:DN\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.67%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.049\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:DN\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.75%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.032\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():de\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.77%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.028\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:rca\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.77%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.028\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():reserca\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.77%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.028\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ca\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.82%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.017\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ets\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.82%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 229 more positive &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 80.00%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 24 more negative &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 87.41%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.270\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():jas\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 87.41%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.270\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:Jas\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 87.59%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.225\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:PA\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 87.59%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.225\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():tpa\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 88.44%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +2.011\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:gen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 88.66%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.955\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():qingming\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.66%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.482\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():warszawapakten\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.78%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.456\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():jaktviggen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.83%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.443\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ple\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.83%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.443\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():kungsäpple\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.83%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.443\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():ölands\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.51%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.294\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:tPA\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.58%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.277\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():viggen\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.87%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.216\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:le\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.98%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.193\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():skulle\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.29%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.126\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():testamentet\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.47%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.090\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():koreakriget\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.60%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.063\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():testamentet\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.85%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.012\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():satansverserna\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.97%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.988\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:et\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.98%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.986\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():&quot;\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.02%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.977\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():inför\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.05%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.972\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ing\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.962\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:word.lower():-\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.11%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.959\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag[:2]:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.11%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.959\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.63%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.858\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.isupper()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.66%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.852\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():under\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.72%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.840\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:get\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.85%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.817\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:37\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.85%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 134 more positive &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 80.00%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 15 more negative &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 89.82%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.675\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:er\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.28%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.569\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():rushdies\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.62%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.491\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ush\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.62%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.491\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:sh\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.62%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.491\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():bush\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.69%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.475\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.isupper()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.69%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.475\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.69%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.475\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 90.86%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.437\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:das\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.03%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.399\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():säger\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.07%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.390\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:jov\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.07%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.390\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():gorbatjov\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.08%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.388\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ov\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.44%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.309\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:rs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.68%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.256\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ter\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.71%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.250\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        EOS\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.74%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.244\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():ricardas\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.85%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.219\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():professor\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.88%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.213\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.istitle()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.91%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.207\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ld\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 91.98%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.191\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ie\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.04%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.180\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:sor\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.167\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():gorbatjovs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.167\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ovs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.167\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:vs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.45%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.094\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:shs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.45%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.094\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:hs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.45%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.094\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():bushs\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 92.45%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 223 more positive &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 89.25%); border: none;\">\n",
       "                <td colspan=\"2\" style=\"padding: 0 0.5em 0 0.5em; text-align: center; border: none; white-space: nowrap;\">\n",
       "                    <i>&hellip; 48 more negative &hellip;</i>\n",
       "                </td>\n",
       "            </tr>\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 89.25%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.811\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        bias\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 86.86%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -2.414\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:en\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                \n",
       "            </tr>\n",
       "        </table>\n",
       "    \n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import eli5\n",
    "\n",
    "eli5.show_weights(crf, top=30)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/ken/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1437: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.\n",
      "  'precision', 'predicted', average, warn_for)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "              precision    recall  f1-score   support\n",
      "\n",
      "         LOC       0.63      0.68      0.65       228\n",
      "           O       0.99      1.00      1.00      9277\n",
      "         ORG       0.00      0.00      0.00        94\n",
      "       OTHER       0.00      0.00      0.00        67\n",
      "         PRS       0.68      0.84      0.75       334\n",
      "\n",
      "    accuracy                           0.97     10000\n",
      "   macro avg       0.46      0.50      0.48     10000\n",
      "weighted avg       0.96      0.97      0.96     10000\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "\n",
       "    <style>\n",
       "    table.eli5-weights tr:hover {\n",
       "        filter: brightness(85%);\n",
       "    }\n",
       "</style>\n",
       "\n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "<table class=\"eli5-transition-features\" style=\"margin-bottom: 0.5em;\">\n",
       "    <thead>\n",
       "        <tr>\n",
       "            <td>From \\ To</td>\n",
       "            \n",
       "                <th>LOC</th>\n",
       "            \n",
       "                <th>O</th>\n",
       "            \n",
       "                <th>ORG</th>\n",
       "            \n",
       "                <th>OTHER</th>\n",
       "            \n",
       "                <th>PRS</th>\n",
       "            \n",
       "        </tr>\n",
       "    </thead>\n",
       "    <tbody>\n",
       "        \n",
       "            \n",
       "                <tr>\n",
       "                    <th>LOC</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; O\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"LOC &rArr; PRS\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>O</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"O &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 90.83%)\" title=\"O &rArr; O\">\n",
       "                            0.887\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"O &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"O &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 97.27%)\" title=\"O &rArr; PRS\">\n",
       "                            -0.157\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>ORG</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; O\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 81.13%)\" title=\"ORG &rArr; ORG\">\n",
       "                            2.485\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"ORG &rArr; PRS\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>OTHER</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; O\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 80.00%)\" title=\"OTHER &rArr; OTHER\">\n",
       "                            2.701\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"OTHER &rArr; PRS\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "                <tr>\n",
       "                    <th>PRS</th>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; LOC\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; O\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; ORG\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(0, 100.00%, 100.00%)\" title=\"PRS &rArr; OTHER\">\n",
       "                            0.0\n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"background-color: hsl(120, 100.00%, 81.06%)\" title=\"PRS &rArr; PRS\">\n",
       "                            2.498\n",
       "                        </td>\n",
       "                    \n",
       "                </tr>\n",
       "            \n",
       "        \n",
       "    </tbody>\n",
       "</table>\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "    \n",
       "        <table class=\"eli5-weights-wrapper\" style=\"border-collapse: collapse; border: none; margin-bottom: 1.5em;\">\n",
       "            <tr>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=LOC\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=O\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=ORG\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=OTHER\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "                    <td style=\"padding: 0.5em; border: 1px solid black; text-align: center;\">\n",
       "                        <b>\n",
       "    \n",
       "        y=PRS\n",
       "    \n",
       "</b>\n",
       "\n",
       "top features\n",
       "                    </td>\n",
       "                \n",
       "            </tr>\n",
       "            <tr>\n",
       "                \n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 93.22%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +1.172\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():i\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 94.49%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.873\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.istitle()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 96.78%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.405\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 96.78%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.405\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag[:2]:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.35%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.156\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:en\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.07%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.069\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.07%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.069\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        \n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 80.00%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +5.498\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        bias\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 97.98%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.208\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        BOS\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.67%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.015\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.67%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.015\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 99.28%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.048\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 99.28%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.048\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 98.91%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.086\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:JJ\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 98.91%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.086\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:JJ\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 96.44%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.467\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:NN\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 96.44%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.467\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:NN\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 94.95%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.769\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.istitle()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 84.13%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -3.949\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 84.13%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -3.949\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.11%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.189\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag[:2]:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.11%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.189\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.04%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.072\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag[:2]:NN\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.04%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.072\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag:NN\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        \n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 96.19%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.514\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 96.19%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.514\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 97.32%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.311\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag[:2]:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 97.32%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.311\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag:RG\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 98.50%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.135\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 98.50%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.135\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                        <td style=\"padding: 0px; border: 1px solid black; vertical-align: top;\">\n",
       "                            \n",
       "                                \n",
       "                                    \n",
       "                                    \n",
       "    \n",
       "    <table class=\"eli5-weights\"\n",
       "           style=\"border-collapse: collapse; border: none; margin-top: 0em; table-layout: auto; width: 100%;\">\n",
       "        <thead>\n",
       "        <tr style=\"border: none;\">\n",
       "            \n",
       "                <th style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\" title=\"Feature weights. Note that weights do not account for feature value scales, so if feature values have different scales, features with highest weights might not be the most important.\">\n",
       "                    Weight<sup>?</sup>\n",
       "                </th>\n",
       "            \n",
       "            <th style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">Feature</th>\n",
       "            \n",
       "        </tr>\n",
       "        </thead>\n",
       "        <tbody>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 95.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.738\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.istitle()\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 97.08%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.352\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag:VB\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 97.08%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.352\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag[:2]:VB\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.08%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.194\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.08%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.194\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        +1:postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.16%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.182\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.16%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.182\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        postag[:2]:PM\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.62%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.120\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:jov\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.62%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.120\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():gorbatjov\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.65%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.116\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:ov\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 98.89%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.088\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:word.lower():säger\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.066\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:sh\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.066\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word.lower():bush\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(120, 100.00%, 99.10%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        +0.066\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-3:]:ush\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "        \n",
       "\n",
       "        \n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 99.90%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.003\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 99.90%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -0.003\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        -1:postag[:2]:PP\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "            <tr style=\"background-color: hsl(0, 100.00%, 93.61%); border: none;\">\n",
       "    <td style=\"padding: 0 1em 0 0.5em; text-align: right; border: none;\">\n",
       "        -1.078\n",
       "    </td>\n",
       "    <td style=\"padding: 0 0.5em 0 0.5em; text-align: left; border: none;\">\n",
       "        word[-2:]:en\n",
       "    </td>\n",
       "    \n",
       "</tr>\n",
       "        \n",
       "\n",
       "        </tbody>\n",
       "    </table>\n",
       "\n",
       "                                \n",
       "                            \n",
       "                        </td>\n",
       "                    \n",
       "                \n",
       "            </tr>\n",
       "        </table>\n",
       "    \n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "        \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "    \n",
       "\n",
       "\n",
       "\n"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "crf = CRF(algorithm='lbfgs',\n",
    "          c1=10,\n",
    "          c2=0.1,\n",
    "          max_iterations=100,\n",
    "          all_possible_transitions=False)\n",
    "pred = cross_val_predict(estimator=crf, X=X, y=y, cv=5)\n",
    "report = flat_classification_report(y_pred=pred, y_true=y)\n",
    "print(report)\n",
    "crf.fit(X, y)\n",
    "eli5.show_weights(crf, top=30)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Split Data into Train/Test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "# drop_cols =  [SENT_COL, TOKEN_COL, POS_COL, NER_COL, TOKEN_SHAPE_COL]\n",
    "# #drop_cols =  [TOKEN_COL]\n",
    "\n",
    "# #swe_data.dtypes\n",
    "# #swe_data[POS_COL] = pd.Categorical(swe_data[POS_COL])\n",
    "# #swe_data[POS_COL] = swe_data.pos.cat.codes\n",
    "# #swe_data.head()\n",
    "# df=swe_data.copy()\n",
    "\n",
    "# for drop_col in drop_cols:\n",
    "#     df.pop(drop_col)\n",
    "# df = df.head(10000)\n",
    "# target = df.pop(NER_CAT_COL)\n",
    "\n",
    "\n",
    "\n",
    "# #dataset = tf.data.Dataset.from_tensor_slices((df.values, target.values))\n",
    "# x=df.values\n",
    "# y=target.values\n",
    "# print(df.values)\n",
    "# print(target.values)\n",
    "# DATASET_LENGTH=len(target.values)\n",
    "\n",
    "# from sklearn.model_selection import train_test_split\n",
    "# from keras.utils import to_categorical\n",
    "# y_binary = to_categorical(y)\n",
    "# xTrain, xTest, yTrain, yTest = train_test_split(x, y_binary, test_size = 0.3, random_state = 0, shuffle=False) #Remove shuffle\n",
    "\n",
    "# print(xTrain[8])\n",
    "# print(yTrain[8])\n",
    "\n",
    "# #for feat, targ in dataset.take(5):\n",
    "# #  print ('Features: {}, Target: {}'.format(feat, targ))\n",
    "# print(yTrain)\n",
    "\n",
    "# INPUT_DIM=len(xTrain[0])\n",
    "# print(\"Input dim:\" + str(INPUT_DIM))\n",
    "# OUTPUT_DIM=max([np.argmax(i) for i in yTrain])+1\n",
    "# print(\"Output dim:\" + str(OUTPUT_DIM))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "#categorical_vars = [POS_COL, NER_COL, TOKEN_SHAPE_COL]\n",
    "#numerical_vars =[]\n",
    "#numerical_vars = ['age', 'siblings_spouses_aboard', 'parents_children_aboard', 'fare']\n",
    "#text_vars = ['name']\n",
    "#text_vars = []\n",
    "\n",
    "#from sklearn.model_selection import train_test_split\n",
    "\n",
    "#train, test = train_test_split(df, test_size=0.3)\n",
    "#print(train.head())\n",
    "#trainLabels = train.as_matrix(columns=[POS_COL])\n",
    "#train = train.as_matrix(columns=['vectorized'])\n",
    "#print(train)\n",
    "#testLabels = test.as_matrix(columns=['label'])\n",
    "#test = test.as_matrix(columns=['vectorized'])\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### LSTM\n",
    "https://www.depends-on-the-definition.com/guide-sequence-tagging-neural-networks-python/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "max len:  64\n",
      "3208\n",
      "{'LOC': 0, 'O': 1, 'OTHER': 2, 'PRS': 3, 'ORG': 4}\n"
     ]
    }
   ],
   "source": [
    "words = list(set(DATA_TESTED[TOKEN_COL].values))\n",
    "tags = list(set(DATA_TESTED[NER_COL].values))\n",
    "n_words = len(words); n_words\n",
    "n_tags = len(tags); n_tags\n",
    "\n",
    "getter = SentenceGetter(DATA_TESTED)\n",
    "sent = getter.get_next()\n",
    "# print(sent)\n",
    "sentences = getter.sentences\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "plt.style.use(\"ggplot\")\n",
    "plt.hist([len(s) for s in sentences], bins=50)\n",
    "plt.show()\n",
    "\n",
    "print(\"max len: \",max([len(s) for s in sentences]))\n",
    "\n",
    "MAX_LEN = max([len(s) for s in sentences])\n",
    "word2idx = {w: i for i, w in enumerate(words)}\n",
    "tag2idx = {t: i for i, t in enumerate(tags)}\n",
    "print(word2idx[\"i\"])\n",
    "print(tag2idx)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "617\n",
      "64\n",
      "64\n"
     ]
    }
   ],
   "source": [
    "from keras.preprocessing.sequence import pad_sequences\n",
    "words = list(set(DATA_TESTED[TOKEN_COL].values))\n",
    "words.append(\"ENDPAD\")\n",
    "tags = list(set(DATA_TESTED[NER_COL].values))\n",
    "n_words = len(words); n_words\n",
    "n_tags = len(tags); n_tags\n",
    "print(len(sentences))\n",
    "\n",
    "from keras.utils import to_categorical\n",
    "X = [[word2idx[w[0]] for w in s] for s in sentences]\n",
    "y = [[tag2idx[w[2]] for w in s] for s in sentences]\n",
    "y = pad_sequences(maxlen=MAX_LEN, sequences=y, padding=\"post\", value=tag2idx[\"O\"])\n",
    "X = pad_sequences(maxlen=MAX_LEN, sequences=X, padding=\"post\", value=n_words - 1)\n",
    "y = [to_categorical(i, num_classes=n_tags) for i in y]\n",
    "print(len(y[1]))\n",
    "print(len(X[1]))\n",
    "# print(X[1])\n",
    "# print(word2idx)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/ken/anaconda3/lib/python3.7/site-packages/tensorflow_core/python/framework/indexed_slices.py:424: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.\n",
      "  \"Converting sparse IndexedSlices to a dense Tensor of unknown shape. \"\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train on 499 samples, validate on 56 samples\n",
      "Epoch 1/3\n",
      "499/499 [==============================] - 9s 18ms/step - loss: 0.4059 - accuracy: 0.9264 - val_loss: 0.1112 - val_accuracy: 0.9785\n",
      "Epoch 2/3\n",
      "499/499 [==============================] - 5s 11ms/step - loss: 0.0931 - accuracy: 0.9819 - val_loss: 0.1129 - val_accuracy: 0.9785\n",
      "Epoch 3/3\n",
      "499/499 [==============================] - 6s 11ms/step - loss: 0.0895 - accuracy: 0.9819 - val_loss: 0.1209 - val_accuracy: 0.9785\n"
     ]
    }
   ],
   "source": [
    "\n",
    "#y = [to_categorical(i, num_classes=n_tags) for i in y]\n",
    "from sklearn.model_selection import train_test_split\n",
    "X_tr, X_te, y_tr, y_te = train_test_split(X, y, test_size=0.1)\n",
    "from keras.models import Model, Input\n",
    "from keras.layers import LSTM, Embedding, Dense, TimeDistributed, Dropout, Bidirectional\n",
    "input = Input(shape=(MAX_LEN,))\n",
    "model = Embedding(input_dim=n_words, output_dim=50, input_length=MAX_LEN)(input)\n",
    "model = Dropout(0.1)(model)\n",
    "model = Bidirectional(LSTM(units=100, return_sequences=True, recurrent_dropout=0.1))(model)\n",
    "out = TimeDistributed(Dense(n_tags, activation=\"softmax\"))(model)  # softmax output layer\n",
    "print(n_tags)\n",
    "model = Model(input, out)\n",
    "model.compile(optimizer=\"rmsprop\", loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\n",
    "history = model.fit(X_tr, np.array(y_tr), batch_size=32, epochs=3, validation_split=0.1, verbose=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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w1Lidgu/39/sLbXDhw8rOzv7vMc0NTXpxIkT8vl8Zz03EAiE/vNVMopmVpL04YcfqrS0VI8++qjS09ND27+cTZcuXdS/f3/9+9//bvXMrkUzs6ysrNCciouLtWfPHkmn5xW+vs4172QS7RqTpLVr1571dmUqrrEL8fv9qqqqCj3+cp6puLai9cknn+j555/XI488oqysrND2L9dWx44ddf311yf1rXXRyszMVEZGhiRp8ODBampqUnV1dUzfx6noXLeJper6amxs1KxZs3TTTTdpyJAhZ+1P5NewlCjJ+fn52r9/vyorK9XY2Ki1a9eqoKCg2THXXXedysrKJEnvvfeerr76ahljVFBQoLVr16qhoUGVlZXav3//WW8VJJNoZrV371794Q9/0KOPPqqOHTuGttfW1qqhoUGSVF1dre3bt6t79+5xze9CNDM7cuRI6Ovy8vLQXAYNGqRNmzaptrZWtbW12rRpU9J/eko085KkL774QsePH1efPn1C21J1jV1IQUGBVq1aJWutduzYoczMTGVnZ6fk2opGVVWVSkpKNHXqVHXt2jW0va6uTidPngx9/eGHH4Y+RSWVHT16NHSlb9euXQoGg8rKyor6+zgVnThxQlu3bm02j1RdX9ZaPffcc+rWrZtuu+22cx6TyK9hKfMT9zZu3Kg///nPCgaDKioq0sSJE7VgwQLl5+eroKBA9fX1evbZZ7V37175fD5NmzZNXbp0kSQtXLhQK1eulMfj0f3333/WPWzJJtKsnnrqKX366afq1KmTpP9+DNf27dv1+9//Xh6PR8FgUGPHjtU3v/lNx2cTH5FmNn/+fJWXl8vr9crn8+nBBx9Ut27dJJ2+L7K0tFTS6Y+4KSoqcnkqcRFpXpL08ssvq6GhQZMnTw49LxXX2G9+8xtt3bpVNTU16tixo+688041NjZKkkaNGiVrrebOnatNmzapXbt2mjJlivLz8yWl5tqKNK/nnntO69atC90D+eVHcR08eFAlJSWSTr+bOGzYME2cONHZecRLpHktXbpUy5Ytk9frVbt27fTd735Xffv2lXTu7+NkF2le0umPLauoqNC0adNCz0vV9bVt2zb9/Oc/V8+ePUO3Stx9992hK8eJ/hqWMiUZAAAAiFZK3G4BAAAAxIKSDAAAAIShJAMAAABhKMkAAABAGEoyAAAAEIaSDAAAAIShJAMAAABh/h/ZbvfCey5ccAAAAABJRU5ErkJggg==\n",
      "text/plain": [
       "<Figure size 864x864 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "hist = pd.DataFrame(history.history)\n",
    "plt.figure(figsize=(12,12))\n",
    "plt.plot(hist[\"accuracy\"])\n",
    "plt.plot(hist[\"val_accuracy\"])\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Word            (True ): Pred\n",
      "De             : O\n",
      "syftar         : O\n",
      "oftast         : O\n",
      "till           : O\n",
      "att            : O\n",
      "staten         : O\n",
      "ska            : O\n",
      "skjuta         : O\n",
      "till           : O\n",
      "mer            : O\n",
      "pengar         : O\n",
      "\"              : O\n",
      ",              : O\n",
      "sa             : O\n",
      "socialministern: O\n",
      ".              : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n",
      "ENDPAD         : O\n"
     ]
    }
   ],
   "source": [
    "i = 2\n",
    "p = model.predict(np.array([X_te[i]]))\n",
    "p = np.argmax(p, axis=-1)\n",
    "print(\"{:15} ({:5}): {}\".format(\"Word\", \"True\", \"Pred\"))\n",
    "for w, pred in zip(X_te[i], p[0]):\n",
    "    print(\"{:15}: {}\".format(words[w], tags[pred]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### LSTM-CRF\n",
    "https://www.depends-on-the-definition.com/sequence-tagging-lstm-crf/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3330\n",
      "5\n"
     ]
    }
   ],
   "source": [
    "# words = list(set(DATA_TESTED[TOKEN_COL].values))\n",
    "# words.append(\"ENDPAD\")\n",
    "# n_words = len(words); \n",
    "# print(n_words)\n",
    "# tags = list(set(DATA_TESTED[NER_COL].values))\n",
    "# n_tags = len(tags); \n",
    "# print(n_tags)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "done\n"
     ]
    }
   ],
   "source": [
    "# class SentenceGetter(object):\n",
    "    \n",
    "#     def __init__(self, data):\n",
    "#         self.n_sent = 1\n",
    "#         self.data = data\n",
    "#         self.empty = False\n",
    "#         agg_func = lambda s: [(w, p, t) for w, p, t in zip(s[TOKEN_COL].values.tolist(),\n",
    "#                                                            s[POS_COL].values.tolist(),\n",
    "#                                                            s[NER_COL].values.tolist())]\n",
    "#         self.grouped = self.data.groupby(SENT_COL).apply(agg_func)\n",
    "#         self.sentences = [s for s in self.grouped]\n",
    "    \n",
    "#     def get_next(self):\n",
    "#         try:\n",
    "#             s = self.grouped[self.n_sent]\n",
    "#             self.n_sent += 1\n",
    "#             return s\n",
    "#         except:\n",
    "#             return None\n",
    "# getter = SentenceGetter(DATA_TESTED)\n",
    "# # sent = getter.get_next()\n",
    "# sentences = getter.sentences\n",
    "\n",
    "# print(\"done\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "# print(\"max len: \",max([len(s) for s in sentences]))\n",
    "# # max_len = max([len(s) for s in sentences])\n",
    "# max_len=75\n",
    "# word2idx = {w: i + 1 for i, w in enumerate(words)}\n",
    "# tag2idx = {t: i for i, t in enumerate(tags)}\n",
    "\n",
    "# from keras.preprocessing.sequence import pad_sequences\n",
    "# X = [[word2idx[w[0]] for w in s] for s in sentences]\n",
    "# X = pad_sequences(maxlen=max_len, sequences=X, padding=\"post\", value=n_words-1)\n",
    "# y = [[tag2idx[w[2]] for w in s] for s in sentences]\n",
    "# y = pad_sequences(maxlen=max_len, sequences=y, padding=\"post\", value=tag2idx[\"O\"])\n",
    "# from keras.utils import to_categorical\n",
    "# y = [to_categorical(i, num_classes=n_tags) for i in y]\n",
    "# from sklearn.model_selection import train_test_split\n",
    "# X_tr, X_te, y_tr, y_te = train_test_split(X, y, test_size=0.1)\n",
    "\n",
    "# print(len(X_tr[44]))\n",
    "# print(len(y_tr[44]))\n",
    "# # for (a,b) in word2idx:\n",
    "# #     if b == 2627:\n",
    "# #         print(a)\n",
    "\n",
    "# print(\"Done\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "# from keras.models import Model, Input\n",
    "# from keras.layers import LSTM, Embedding, Dense, TimeDistributed, Dropout, Bidirectional\n",
    "# from keras_contrib.layers import CRF\n",
    "\n",
    "# input = Input(shape=(max_len,))\n",
    "# model = Embedding(input_dim=n_words + 1, output_dim=20,\n",
    "#                   input_length=max_len, mask_zero=True)(input)  # 20-dim embedding\n",
    "# model = Bidirectional(LSTM(units=50, return_sequences=True,\n",
    "#                            recurrent_dropout=0.1))(model)  # variational biLSTM\n",
    "# model = TimeDistributed(Dense(50, activation=\"relu\"))(model)  # a dense layer as suggested by neuralNer\n",
    "# crf = CRF(n_tags)  # CRF layer\n",
    "# out = crf(model)  # output\n",
    "\n",
    "# model = Model(input, out)\n",
    "# model.compile(optimizer=\"rmsprop\", loss=crf.loss_function, metrics=[crf.accuracy])\n",
    "# model.summary()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n",
    "#### Train Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# def get_compiled_model():\n",
    "#   model = tf.keras.Sequential([\n",
    "#     tf.keras.layers.Dense(10, activation='relu', input_shape=(2,)),\n",
    "#     tf.keras.layers.Dense(10, activation='relu'),\n",
    "#     tf.keras.layers.Dense(1, activation='sigmoid')\n",
    "#   ])\n",
    "\n",
    "#   model.compile(optimizer='adam',\n",
    "#                 loss='categorical_crossentropy',\n",
    "#                 metrics=['accuracy'])\n",
    "#   return model\n",
    "\n",
    "model = tf.keras.Sequential()\n",
    "model.add(tf.keras.layers.Dense(65, input_dim=INPUT_DIM, activation='relu'))\n",
    "#model.add(tf.keras.layers.Dense(22, activation='relu'))\n",
    "#model.add(tf.keras.layers.Dense(22, activation='relu'))\n",
    "model.add(tf.keras.layers.Dense(OUTPUT_DIM, activation='softmax'))\n",
    "# Compile model\n",
    "#model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=[keras.metrics.Precision(), keras.metrics.Recall()])\n",
    "#model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=[keras.metrics.Recall()])\n",
    "#model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=[keras.metrics.Precision()])\n",
    "\n",
    "# https://appliedmachinelearning.blog/2019/04/01/training-deep-learning-based-named-entity-recognition-from-scratch-disease-extraction-hackathon/\n",
    "\n",
    "\n",
    "#model = get_compiled_model()\n",
    "model.fit(xTrain,yTrain, epochs=32)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Test Accuracy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "threeDataPoints = xTest[:3]\n",
    "print(threeDataPoints)\n",
    "predictions = model.predict(threeDataPoints)\n",
    "for prediction in predictions:\n",
    "    index = np.argmax(prediction)\n",
    "    print(index)\n",
    "    print(prediction[index])\n",
    "\n",
    "predictions = model.predict(xTest)\n",
    "print(\"Features|Prediction|Target\")\n",
    "for i in range(len(predictions)):\n",
    "    index = np.argmax(predictions[i])\n",
    "    if index != 1:\n",
    "        #only 1's\n",
    "        print(str(xTest[i]) + \" \" + str(index) + \" \" + str(np.argmax(yTest[i])))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "results = model.evaluate(xTest,yTest, verbose=0)\n",
    "print('test loss, test acc, test recall:', results)\n",
    "\n",
    "#Only Acc, 142, 7000, feat:1,2,-1 : [0.22299354140212138, 0.9714275]\n",
    "#[0.2284703826159239, 0.9709106, 0.92750543]\n",
    "#Recall [0.22716047498087089, 0.9273468]\n",
    "\n",
    "# 142, standardized [0.16994940752536059, 0.9674706, 0.9300009]\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Save Model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#https://github.com/floydhub/named-entity-recognition-template/blob/master/ner.ipynb\n",
    "# Saving Vocab\n",
    "#with open('models/word_to_index.pickle', 'wb') as handle:\n",
    "#    pickle.dump(word2idx, handle, protocol=pickle.HIGHEST_PROTOCOL)\n",
    " \n",
    "# Saving Vocab\n",
    "#with open('models/tag_to_index.pickle', 'wb') as handle:\n",
    "#    pickle.dump(tag2idx, handle, protocol=pickle.HIGHEST_PROTOCOL)\n",
    "    \n",
    "# Saving Model Weight\n",
    "#model.save_weights('models/lstm_crf_weights.h5')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
